---
title: "histoCAT_SCNA_comparison"
output: html_notebook
---
Continue with output file from inital histocat script

```{r}
try = as.data.frame(out) %>% select(from_label, to_label, p_lt, group_by)
table(try$group_by)

### From here k-means, but rather try hierarchical clustering
try$key = paste(try$from_label, try$to_label, sep = "_")
try = try %>% select(-c(from_label, to_label))

try = spread(try, key = key, value = p_lt)

library(ggplot2)
library(pheatmap)

rownames(try) = try$group_by
pheatmap(try[,-1], treeheight_row = 0, treeheight_col = 0)
pheatmap(try[,-1], kmeans_k = 2, treeheight_row = 0, treeheight_col = 0)

pheatmap(try[,-1], clustering_distance_rows="euclidean", clustering_method="median", 
         kmeans_k = 2, show_rownames=TRUE)

km <- kmeans(try[,-1], centers=2)
cluster_assignments <- km$cluster
result = cbind(try[,1],cluster_assignments)



```


